# /nexus-infra/nginx/nginx.conf  nginx 설정 파일
user nginx;                 # Nginx 워커 프로세스 사용자 권한
worker_processes auto;      # CPU 코어수별 자동으로 워커 프로세스 설정

error_log /var/log/nginx/error.log warn;    # 에러 로그 파일 위치 및 로그 레벨
pid       /var/run/nginx.pid;               # Nginx PID 파일 위치

events {
    worker_connections 1024;                # 각 워커가 동시에 처리 가능한 최대 connection 수
}

http {
    # 기본 MIME 타입 및 파일 처리 설정
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    # 로그 설정
    access_log /var/log/nginx/access.log;
    error_log  /var/log/nginx/error.log;

    # 파일 압축 활성화 (gzip)
    # 프론트엔드 정적 파일 서비스 시 매우 중요!
    gzip on;
    gzip_types text/plain text/css application/json application/javascript application/xml;
    gzip_min_length 1024;

    # keepalive 연결 설정 : 클라이언트에서 연결이 유지될 시간을 정의. defalut 65
    keepalive_timeout 65;

    # 업로드 제한 (필요 시 수정)
    client_max_body_size 10M;

    # 서버 설정을 외부 파일에서 include
    # Ubuntu 기본 디렉토리 구조:
    # /etc/nginx/sites-available/
    # /etc/nginx/sites-enabled/
    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
}

